<html>
<head>
<title>Highsight</title>
<script type="text/javascript" src="jquery/dist/jquery.min.js"></script>
<link rel="stylesheet" href="bootstrap/dist/css/bootstrap.min.css">
<script type="text/javascript" src="bootstrap/dist/js/bootstrap.min.js"></script>
<style>
body, html {
  width: 100%;
  background: black;
  color: white;
  text-align: center;
}
p {
  margin: .4em;
}
</style>
</head>

<body>
<h1>Highsight</h1>
<div class="pure-g">
  <div class="pure-u-1-2">
	<p><a id="goUpSlow" class="pure-button">Go Up Slow</a></p>
	<p><a id="goDownSlow" class="pure-button">Go Down Slow</a></p>
	<p><a id="goDownFast" class="pure-button">Go Down Fast</a></p>
	<p><input id="loop" type="checkbox"> Loop</p>
  </div>
  <div class="pure-u-1-2 pure-form">
  	<p id='serialStatus'></p>
	<p><input type="text" placeholder="0" id="position"></p>
	<p><a id="getPosition" class="pure-button">Get Position</a></p>
  </div>
</div>

<script>
function checkStatus() {
	$.get('serial/open', function(res, err) {
		if(res.open) {
			$('#serialStatus').hide();
		} else {
			$('#serialStatus').show();
			$('#serialStatus').text('Serial is ' + res.status + '.');
		}
	})
}
var upDuration = 7000;
var loopDuration = 12000;
function cycle() {
	setTimeout(function() { $.get('goUpSlow') }, 0);
	setTimeout(function() { $.get('goDownFast') }, upDuration);
}
var loop;
$(function() {
	$('#goUpSlow').click(function() { $.get('goUpSlow'); });
	$('#goDownSlow').click(function() { $.get('goDownSlow'); });
	$('#goDownFast').click(function() { $.get('goDownFast'); });
	$('#getPosition').click(function() {
		$.get('readEncoderCounterAbsolute', function(res, err) {
			console.log(res);
			console.log(err);
		});
	});
	$('#loop').click(function() {
		if($(this).is(':checked')) {
			cycle();
			loop = setInterval(cycle, loopDuration);
		} else {
			clearInterval(loop);
		}
	});
	checkStatus();
	setInterval(checkStatus, 1000);
})
</script>

</body>
</html>